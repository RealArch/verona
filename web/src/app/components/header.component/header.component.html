<nav class="bg-primary/80 text-white border-b border-primary shadow-sm backdrop-blur-xl">
    <div class="navbar container mx-auto px-4">
        @if (!isMobileSearchActive()) {
        <div class="navbar-start">
            <a routerLink="/">
                <img class="h-full max-h-[4rem] w-25 lg:w-30 object-contain" style="aspect-ratio:1/1;"
                    src="logos/logo_verona_white.svg" alt="Logo de Verona">
            </a>
        </div>

        <div class="navbar-center hidden lg:flex">
            <form class="form-control" (submit)="onSearchSubmit($event)">
                <div class="input-group">
                    <input type="text" placeholder="Buscar productos..."
                        class="input w-80 focus:input-primary input-primary bg-primary-alt/50 text-white mr-2"
                        [value]="searchQuery()" (input)="onSearchInput($event)" (keypress)="onSearchKeyPress($event)" />
                    <button type="submit" class="btn btn-circle btn-ghost h-full py-1.5">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </button>
                </div>
            </form>
        </div>

        <div class="navbar-end flex items-center gap-2">
            <button type="button" class="btn btn-ghost btn-circle lg:hidden" (click)="openMobileSearch()"
                aria-label="Abrir búsqueda">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
            </button>

            @if(isAuthenticated()) {
            <div class="dropdown dropdown-end">
                <div tabindex="0" role="button">
                    <button tabindex="0" role="button" aria-label="Menú de usuario"
                        class="button-login btn btn-ghost flex items-center gap-2 px-2 lg:px-4 text-start">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 lg:hidden icon icon-tabler icons-tabler-outline icon-tabler-user-circle"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M12 10m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" /><path d="M6.168 18.849a4 4 0 0 1 3.832 -2.849h4a4 4 0 0 1 3.834 2.855" /></svg>
                        <div class="hidden lg:flex flex-col leading-tight">
                            <span>Hola,</span>
                            <span>{{userProfile()?.firstName | titlecase}} ▼</span>
                        </div>
                    </button>
                </div>

                <ul tabindex="0"
                    class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-52 border border-base-300">
                    <li>
                        <a class="justify-between text-base-content hover:bg-primary/10"
                            (click)="closeDropdownAndNavigate('/user/profile')">
                            Mi Perfil
                        </a>
                    </li>
                    <li>
                        <a class="text-base-content hover:bg-primary/10"
                            (click)="closeDropdownAndNavigate('user/orders')">
                            Mis Pedidos
                        </a>
                    </li>
                    <li>
                        <a class="text-base-content hover:bg-primary/10"
                            (click)="closeDropdownAndNavigate('user/wishlist')">
                            Lista de Deseos
                        </a>
                    </li>
                 
                        <hr class="border-base-300">
               
                    <li>
                        <a class="text-error hover:bg-error/10" (click)="logout();closeDropdownAndAction()">
                            Cerrar Sesión
                        </a>
                    </li>
                </ul>

            </div>
            } @else {

            <button tabindex="0" role="button" aria-label="Iniciar sesión"
                class="button-login btn btn-ghost flex items-center gap-2 px-2 lg:px-4 text-start"
                (click)="navigateToLogin()">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 lg:hidden icon icon-tabler icons-tabler-outline icon-tabler-user-circle"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M12 10m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" /><path d="M6.168 18.849a4 4 0 0 1 3.832 -2.849h4a4 4 0 0 1 3.834 2.855" /></svg>
                <div class="hidden lg:flex flex-col leading-tight">
                    <span>Hola,</span>
                    <span>Iniciar Sesión ▼</span>
                </div>

            </button>

            }

            <div class="dropdown dropdown-end">
                <div tabindex="0" role="button" class="btn btn-ghost btn-circle relative">
                    <div class="indicator">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5H19M7 13l-1.1 5M7 13l1.1-5m8.9 5L17 8m2 5l1.1 5M9 21a1 1 0 11-2 0 1 1 0 012 0zm10 0a1 1 0 11-2 0 1 1 0 012 0z">
                            </path>
                        </svg>
                        <span
                            class="badge badge-xs indicator-item badge-accent text-accent-content rounded-full w-5 h-5 flex items-center justify-center">
                            {{cartItemsCount().uniqueItemCount}}
                        </span>
                    </div>
                </div>
                <div tabindex="0"
                    class="mt-3 z-[1] card card-compact dropdown-content w-80 bg-base-100 shadow-xl border border-base-300">
                    <div class="card-body">
                        <span class="font-bold text-lg text-base-content">{{cartItemsCount().itemCount}} Items</span>
                        <span class="text-primary text-sm">Subtotal: ${{cartItemsCount().subtotal}}</span>
                        <div class="card-actions">
                            <button class="btn btn-primary btn-block"
                                (click)="closeDropdownAndNavigate('/shopping-cart')">
                                Ver Carrito
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        } @else {
        <div class="flex w-full items-center gap-2 py-2 lg:hidden">
            <button type="button" class="btn btn-ghost btn-circle shrink-0" (click)="closeMobileSearch()"
                aria-label="Cerrar búsqueda">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            <form class="flex-1 min-w-0" (submit)="onSearchSubmit($event)">
                <div class="input-group flex w-full items-center whitespace-nowrap">
                    <input #mobileSearchInput type="text" placeholder="Buscar productos..."
                        class="input input-primary flex-1 min-w-0 bg-primary-alt/50 text-white"
                        [value]="searchQuery()" (input)="onSearchInput($event)"
                        (keypress)="onSearchKeyPress($event)" />
                    <button type="submit" class="btn btn-ghost btn-circle shrink-0 text-white" aria-label="Buscar">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </button>
                </div>
            </form>
        </div>
        }
    </div>

    <!-- Barra de navegación secundaria (opcional) -->
    <!-- <div class="bg-gradient-to-r from-primary-alt/10 via-transparent to-primary-alt/90 border-t border-base-200">
        <div class="container mx-auto px-4 py-2">
            <div class="flex items-center justify-center gap-6 text-sm">
                <a href="#sofas" class="text-white/80 hover:text-gold transition-colors">Sofás</a>
                <a href="#mesas" class="text-white/80 hover:text-gold transition-colors">Mesas</a>
                <a href="#sillas" class="text-white/80 hover:text-gold transition-colors">Sillas</a>
                <a href="#decoracion" class="text-white/80 hover:text-gold transition-colors">Decoración</a>
                <a href="#dormitorio" class="text-white/80 hover:text-gold transition-colors">Dormitorio</a>
            </div>
        </div>
    </div> -->
</nav>