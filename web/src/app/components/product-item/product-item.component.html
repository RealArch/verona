<div class="item h-full w-full cursor-pointer overflow-hidden" (click)="navigateToProduct(product)">
    <div
        class="bg-white/5 backdrop-blur-xl rounded-2xl border border-white/10 shadow-lg overflow-hidden hover:bg-white/10 transition-all duration-500 hover:scale-[1.02] hover:shadow-primary/20 h-full flex flex-col">
        <!-- Imagen con relación de aspecto rectangular adaptable -->
        <div class="relative w-full aspect-[4/3] overflow-hidden">

            @if(product.photos && product.photos.length > 0 && product.photos[0].small && product.photos[0].small.url) {
            <img [src]="product.photos[0].small.url" [alt]="product.slug"
                class="w-full h-full object-cover object-center absolute inset-0" />
            <div class="absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent"></div>

            } @else {
            <div class="flex items-center justify-center w-full h-full absolute inset-0 bg-base-200">
                <img class="no-img max-w-[60%] max-h-[60%] object-contain" src="img/no-image.svg"
                    alt="No Image Available">

            </div>
            }

            <!-- Overlay glass sutil -->

            <!-- Badge glass flotante -->
            <!-- <div
                class="absolute top-2 left-2 bg-white/20 backdrop-blur-md rounded-full px-2 py-0.5 border border-white/30">
                <span class="text-[10px] font-semibold text-white">-15%</span>
            </div> -->
        </div>
        <!-- Contenido minimalista y responsivo -->
        <div class="p-3 flex flex-col flex-grow">
            <div class="mb-2">
                <h3 class="text-sm font-semibold text-base-content mb-1 leading-tight line-clamp-2 min-h-[2.5em]">
                    {{ product.name }}
                </h3>
                <div class="flex items-center gap-1 text-md pt-4">
                    @if(product.variants.length == 0) {
                    <div class="font-bold text-primary">{{ product.minPrice | currency }}</div>
                    } @else {
                    Desde <div class="font-bold text-primary">{{ product.minPrice| currency }}</div>
                    }
                </div>
            </div>
            <!-- Botones de acción: agregar y wishlist -->
            <div class="mt-auto pt-4 flex gap-2 items-center">
                @if(product.variants.length === 0) {
                <button
                    class="w-9 h-9 bg-primary/20 backdrop-blur-sm text-primary border border-primary/30 rounded-full flex items-center justify-center hover:bg-primary/30 transition-all duration-300 hover:scale-110 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
                    [disabled]="isAddingToCart()"
                    (click)="addToCart($event)">
                    @if (isAddingToCart()) {
                        <span class="loading loading-spinner loading-xs"></span>
                    } @else {
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 icon icon-tabler icons-tabler-outline icon-tabler-shopping-cart-plus">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M4 19a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
                            <path d="M12.5 17h-6.5v-14h-2" />
                            <path d="M6 5l14 1l-.86 6.017m-2.64 .983h-10.5" />
                            <path d="M16 19h6" />
                            <path d="M19 16v6" />
                        </svg>
                    }
                </button>
                }
                <button
                    class="ml-auto w-9 h-9 rounded-full border flex items-center justify-center transition-all duration-300 hover:scale-110 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
                    [class.bg-red-500]="isInWishlist()"
                    [class.border-red-500]="isInWishlist()"
                    [class.bg-red-100/80]="!isInWishlist()"
                    [class.border-red-200]="!isInWishlist()"
                    [class.hover:bg-red-600]="isInWishlist()"
                    [class.hover:bg-red-200]="!isInWishlist()"
                    [disabled]="isAddingToWishlist()"
                    (click)="toggleFavorite($event)">
                    @if (isAddingToWishlist()) {
                        <span class="loading loading-spinner loading-xs text-red-500"></span>
                    } @else {
                        <svg class="w-5 h-5 transition-all" 
                             [class.text-white]="isInWishlist()"
                             [class.text-red-500]="!isInWishlist()"
                             [attr.fill]="isInWishlist() ? 'currentColor' : 'none'" 
                             stroke="currentColor" 
                             viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z">
                            </path>
                        </svg>
                    }
                </button>
            </div>
        </div>
    </div>
</div>